---
import "@fontsource-variable/inter";
import "../styles/global.css";

import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";

interface Props {
  title: string;
  description?: string;
}

const {
  title,
  description = "Alan Chan helps business owners scale â€” mentorship, strategy, and hands-on guidance to grow past your current ceiling.",
} = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title} | Mentorship Ltd</title>
    <meta name="description" content={description} />
    <link rel="icon" type="image/png" href="/images/logos/logo-icon-32.png" />
    <link rel="apple-touch-icon" href="/images/logos/logo-icon-180.png" />
  </head>
  <body class="min-h-screen flex flex-col">
    <Header currentPath={Astro.url.pathname} />
    <main class="flex-1">
      <slot />
    </main>
    <Footer />

    <script>
      import Lenis from "lenis";
      import { animate, inView } from "motion";

      /* ---------- Lenis smooth scroll ---------- */
      let lenis: Lenis;

      function initLenis() {
        lenis?.destroy();
        lenis = new Lenis();

        function raf(time: number) {
          lenis.raf(time);
          requestAnimationFrame(raf);
        }
        requestAnimationFrame(raf);
      }

      initLenis();
      document.addEventListener("astro:after-swap", initLenis);

      /* ---------- Motion scroll-triggered animations ---------- */
      const presets: Record<string, { from: Record<string, number>; to: Record<string, number> }> = {
        "fade-up":    { from: { opacity: 0, y: 24 },  to: { opacity: 1, y: 0 } },
        "fade-left":  { from: { opacity: 0, x: -24 }, to: { opacity: 1, x: 0 } },
        "fade-right": { from: { opacity: 0, x: 24 },  to: { opacity: 1, x: 0 } },
        "scale-in":   { from: { opacity: 0, scale: 0.95 }, to: { opacity: 1, scale: 1 } },
      };

      function initMotion() {
        const els = document.querySelectorAll<HTMLElement>("[data-motion]");
        els.forEach((el) => {
          const name = el.dataset.motion || "fade-up";
          const preset = presets[name] || presets["fade-up"];
          const delay = parseFloat(el.dataset.motionDelay || "0");

          // Reset element to initial state
          Object.assign(el.style, {
            opacity: "0",
          });

          inView(el, () => {
            animate(el, preset.to, {
              duration: 0.6,
              delay,
              ease: [0.25, 0.1, 0.25, 1],
            });
          }, { amount: 0.15 });
        });
      }

      initMotion();
      document.addEventListener("astro:after-swap", initMotion);
    </script>
  </body>
</html>
