---
import "@fontsource-variable/inter";
import "@fontsource-variable/playfair-display";
import "../styles/global.css";

import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";

interface Props {
  title: string;
  description?: string;
}

const {
  title,
  description = "Elevateo Co â€” Alan Chan helps business owners scale with mentorship, strategy, and hands-on guidance to grow past your current ceiling.",
} = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title} | Elevateo Co</title>
    <meta name="description" content={description} />
    <link rel="icon" type="image/png" href="/images/logos/logo-icon-32.png" />
    <link rel="apple-touch-icon" href="/images/logos/logo-icon-180.png" />
  </head>
  <body class="min-h-screen flex flex-col">
    <Header currentPath={Astro.url.pathname} />
    <main class="flex-1">
      <slot />
    </main>
    <Footer />

    <script>
      import Lenis from "lenis";
      import { animate, inView } from "motion";

      /* ---------- Lenis smooth scroll ---------- */
      let lenis: Lenis;

      function initLenis() {
        lenis?.destroy();
        lenis = new Lenis();

        function raf(time: number) {
          lenis.raf(time);
          requestAnimationFrame(raf);
        }
        requestAnimationFrame(raf);
      }

      initLenis();
      document.addEventListener("astro:after-swap", initLenis);

      /* ---------- Animation presets (elevateoco-style) ---------- */
      const presets: Record<string, { to: Record<string, number> }> = {
        "fade-up":       { to: { opacity: 1, y: 0 } },
        "fade-left":     { to: { opacity: 1, x: 0 } },
        "fade-right":    { to: { opacity: 1, x: 0 } },
        "scale-in":      { to: { opacity: 1, scale: 1 } },
        "fade-up-scale": { to: { opacity: 1, y: 0, scale: 1 } },
      };

      /* Set initial styles based on animation type */
      function setInitialState(el: HTMLElement, name: string) {
        const styles: Record<string, string> = { opacity: "0" };
        if (name === "fade-up")          { styles.transform = "translateY(30px)"; }
        else if (name === "fade-left")   { styles.transform = "translateX(-30px)"; }
        else if (name === "fade-right")  { styles.transform = "translateX(30px)"; }
        else if (name === "scale-in")    { styles.transform = "scale(0.95)"; }
        else if (name === "fade-up-scale") { styles.transform = "translateY(20px) scale(0.95)"; }
        Object.assign(el.style, styles);
      }

      /* ---------- Hero entrance animations (load-triggered, staggered) ---------- */
      function initHeroMotion() {
        const heroEls = document.querySelectorAll<HTMLElement>("[data-hero-motion]");
        heroEls.forEach((el) => {
          const name = el.dataset.heroMotion || "fade-up";
          const preset = presets[name] || presets["fade-up"];
          const delay = parseFloat(el.dataset.heroDelay || "0");

          setInitialState(el, name);

          // Animate immediately on page load (like elevateoco hero)
          animate(el, preset.to, {
            duration: 0.8,
            delay,
            ease: [0.25, 0.1, 0.25, 1],
          });
        });
      }

      /* ---------- Scroll-triggered animations ---------- */
      function initMotion() {
        const els = document.querySelectorAll<HTMLElement>("[data-motion]");
        els.forEach((el) => {
          const name = el.dataset.motion || "fade-up";
          const preset = presets[name] || presets["fade-up"];
          const delay = parseFloat(el.dataset.motionDelay || "0");
          const duration = parseFloat(el.dataset.motionDuration || "0.6");

          setInitialState(el, name);

          inView(el, () => {
            animate(el, preset.to, {
              duration,
              delay,
              ease: [0.25, 0.1, 0.25, 1],
            });
          }, { amount: 0.15 });
        });
      }

      initHeroMotion();
      initMotion();
      document.addEventListener("astro:after-swap", () => {
        initHeroMotion();
        initMotion();
      });
    </script>
  </body>
</html>
