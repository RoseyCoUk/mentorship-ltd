---
import Base from "../layouts/Base.astro";
import SectionWrapper from "../components/SectionWrapper.astro";
import Button from "../components/Button.astro";
import FormInput from "../components/FormInput.astro";

const steps = [
  { icon: "interview", title: "We Talk", desc: "A free, no-pressure call to understand your business and what you are trying to achieve." },
  { icon: "analytics", title: "I Assess", desc: "I dig into your situation and identify the biggest levers for growth." },
  { icon: "dashboard", title: "We Decide", desc: "If it is a fit, we build a plan and get to work. If not, no hard feelings." },
];
---

<Base title="Contact" description="Book a free call with Alan Chan. Let's talk about your business, where you want to go, and how mentorship can get you there.">

  <!-- Hero Section -->
  <SectionWrapper class="pt-16 sm:pt-20 pb-8 sm:pb-12">
    <h1 class="text-h1 text-center mb-4">Let's Talk</h1>
    <p class="text-body-lg text-text-secondary text-center max-w-2xl mx-auto">
      Book a free call and tell me about your business. No pitch, no pressure — just a conversation to see if we are a good fit to work together.
    </p>
  </SectionWrapper>

  <!-- What to Expect Section -->
  <section class="bg-navy-950">
    <SectionWrapper width="wide">
      <div class="text-center mb-12">
        <h2 class="text-h2 mb-4">What to Expect</h2>
        <p class="text-body-lg text-text-secondary max-w-2xl mx-auto">
          Simple, straightforward process. No hoops to jump through.
        </p>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        {steps.map((step, i) => (
          <div class="text-center">
            <img
              src={`/images/icons/${step.icon}.webp`}
              alt=""
              width="64"
              height="64"
              class="w-16 h-16 mx-auto mb-4"
              loading="lazy"
            />
            <div class="text-accent font-bold text-sm uppercase tracking-wide mb-2">Step {i + 1}</div>
            <h3 class="text-h3 mb-2">{step.title}</h3>
            <p class="text-text-secondary">{step.desc}</p>
          </div>
        ))}
      </div>
    </SectionWrapper>
  </section>

  <!-- Contact Form Section -->
  <SectionWrapper width="narrow" id="signup">
    <h2 class="text-h2 text-center mb-4">Send Me a Message</h2>
    <p class="text-body-lg text-text-secondary text-center max-w-2xl mx-auto mb-10">
      Fill out the form below and I will get back to you within 24 hours to set up a call.
    </p>
    <form id="contact-form" class="space-y-4 max-w-lg mx-auto">
      <FormInput
        type="text"
        name="name"
        placeholder="Your name"
        required={true}
      />
      <FormInput
        type="email"
        name="email"
        placeholder="Your email"
        required={true}
      />
      <FormInput
        type="tel"
        name="phone"
        placeholder="Phone number (optional)"
      />
      <textarea
        name="business"
        placeholder="Tell me about your business and what you are looking to achieve"
        required
        rows="5"
        class="w-full bg-navy-800 border border-navy-600 text-white placeholder-text-tertiary rounded-lg px-4 py-3 text-body focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent transition-colors duration-200 resize-vertical"
      ></textarea>
      <div class="text-center pt-2">
        <Button variant="primary" size="lg">Send Message</Button>
      </div>
    </form>
    <p id="contact-form-message" class="text-sm mt-3 text-center hidden"></p>
  </SectionWrapper>

  <!-- Email Signup Section -->
  <section class="bg-navy-800">
    <SectionWrapper width="narrow" class="text-center">
      <h2 class="text-h2 mb-4">Not Ready for a Call?</h2>
      <p class="text-body-lg text-text-secondary mb-8 max-w-xl mx-auto">
        No problem. Join my email list for weekly scaling strategies and business breakdowns — or email me directly at <a href="mailto:alan@mentorshipltd.com" class="text-accent hover:text-accent-hover transition-colors">alan@mentorshipltd.com</a>.
      </p>
      <form id="email-signup" class="flex flex-col sm:flex-row gap-3 max-w-md mx-auto">
        <FormInput
          type="email"
          name="email"
          placeholder="Enter your email"
          required={true}
          class="flex-1"
        />
        <Button variant="primary" size="md">Join the List</Button>
      </form>
      <p id="email-form-message" class="text-sm mt-3 hidden"></p>
      <p class="text-xs text-text-tertiary mt-4">
        No spam. Unsubscribe anytime.
      </p>
    </SectionWrapper>
  </section>

  <script>
    function setupContactForms() {
      // Contact form
      const contactForm = document.getElementById('contact-form') as HTMLFormElement;
      const contactMessage = document.getElementById('contact-form-message') as HTMLElement;

      contactForm?.addEventListener('submit', (e) => {
        e.preventDefault();
        const data = new FormData(contactForm);
        const name = data.get('name') as string;
        const email = data.get('email') as string;
        const business = data.get('business') as string;

        if (!name || !email || !email.includes('@') || !business) {
          contactMessage.textContent = 'Please fill in all required fields.';
          contactMessage.className = 'text-sm mt-3 text-center text-error';
          contactMessage.classList.remove('hidden');
          return;
        }

        contactMessage.textContent = "Message sent! I'll be in touch within 24 hours.";
        contactMessage.className = 'text-sm mt-3 text-center text-success';
        contactMessage.classList.remove('hidden');
        contactForm.reset();
      });

      // Email signup form
      const emailForm = document.getElementById('email-signup') as HTMLFormElement;
      const emailMessage = document.getElementById('email-form-message') as HTMLElement;

      emailForm?.addEventListener('submit', (e) => {
        e.preventDefault();
        const email = new FormData(emailForm).get('email') as string;

        if (!email || !email.includes('@')) {
          emailMessage.textContent = 'Please enter a valid email address.';
          emailMessage.className = 'text-sm mt-3 text-error';
          emailMessage.classList.remove('hidden');
          return;
        }

        emailMessage.textContent = "You're in! I'll be in touch.";
        emailMessage.className = 'text-sm mt-3 text-success';
        emailMessage.classList.remove('hidden');
        emailForm.reset();
      });
    }

    setupContactForms();
    document.addEventListener('astro:after-swap', setupContactForms);
  </script>

</Base>
